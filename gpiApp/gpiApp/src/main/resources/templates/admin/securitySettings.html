<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Settings - Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-tasks"></i>
                <span>Task Manager</span>
            </div>
        </div>

        <nav class="sidebar-nav">
            <a th:href="@{/admin/dashboard}" class="nav-item" data-page="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>

            <a th:href="@{/admin/user-management}" class="nav-item" data-page="user-management">
                <i class="fas fa-users"></i>
                <span>User Management</span>
            </a>

            <a th:href="@{/admin/create-user}" class="nav-item" data-page="create-user">
                <i class="fas fa-user-plus"></i>
                <span>Create User</span>
            </a>

            <a th:href="@{/admin/roles-permissions}" class="nav-item" data-page="roles-permissions">
                <i class="fas fa-user-shield"></i>
                <span>Roles & Permissions</span>
            </a>

            <a th:href="@{/admin/project-management}" class="nav-item" data-page="project-management">
                <i class="fas fa-project-diagram"></i>
                <span>Project Management</span>
            </a>

            <a th:href="@{/admin/global-tasks}" class="nav-item" data-page="global-tasks">
                <i class="fas fa-tasks"></i>
                <span>Global Tasks</span>
            </a>

            <a th:href="@{/admin/team-assignment}" class="nav-item" data-page="team-assignment">
                <i class="fas fa-users-cog"></i>
                <span>Team Assignment</span>
            </a>

            <a th:href="@{/admin/global-reports}" class="nav-item" data-page="global-reports">
                <i class="fas fa-chart-bar"></i>
                <span>Global Reports</span>
            </a>

            <a th:href="@{/admin/activity-logs}" class="nav-item" data-page="activity-logs">
                <i class="fas fa-history"></i>
                <span>Activity Logs</span>
            </a>

            <a th:href="@{/admin/system-settings}" class="nav-item" data-page="system-settings">
                <i class="fas fa-cog"></i>
                <span>System Settings</span>
            </a>

            <a th:href="@{/admin/integrations}" class="nav-item" data-page="integrations">
                <i class="fas fa-plug"></i>
                <span>Integrations</span>
            </a>

            <a th:href="@{/admin/security-backups}" class="nav-item" data-page="security">
                <i class="fas fa-shield-alt"></i>
                <span>Security & Backup</span>
            </a>

            <div class="nav-divider"></div>

            <a th:href="@{/admin/support}" class="nav-item" data-page="support">
                <i class="fas fa-life-ring"></i>
                <span>Support Center</span>
            </a>

            <a th:href="@{/api/auth/logout-confirm}" id="logout-link" class="nav-item" style="margin-top: auto;">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Include Top Bar Fragment -->
        <div th:replace="~{fragments/adminfragmentTB :: topbar}"></div>

        <!-- Content Wrapper -->
        <div class="content-wrapper">
            <!-- Security Settings Page -->
            <div class="page-content active" id="security-settings">
                <div class="section-header">
                    <h2 class="section-title">Security Settings</h2>
                    <button class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                </div>

                <!-- Security Overview -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-info">
                            <h3>95%</h3>
                            <p>Security Score</p>
                        </div>
                        <div class="stat-icon" style="background-color: rgba(40, 167, 69, 0.1); color: var(--success);">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-info">
                            <h3>23</h3>
                            <p>Failed Login Attempts</p>
                        </div>
                        <div class="stat-icon" style="background-color: rgba(220, 53, 69, 0.1); color: var(--danger);">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-info">
                            <h3>5</h3>
                            <p>Blocked IPs</p>
                        </div>
                        <div class="stat-icon" style="background-color: rgba(255, 193, 7, 0.1); color: var(--warning);">
                            <i class="fas fa-ban"></i>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-info">
                            <h3>2FA</h3>
                            <p>Enabled Users</p>
                        </div>
                        <div class="stat-icon" style="background-color: rgba(23, 162, 184, 0.1); color: var(--info);">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                    </div>
                </div>

                <!-- Authentication Settings -->
                <div class="card">
                    <div class="card-header">
                        <h3>Authentication Settings</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label for="session-timeout">Session Timeout (minutes)</label>
                                <input type="number" id="session-timeout" class="form-control" value="30" min="5" max="480">
                            </div>
                            <div class="form-group">
                                <label for="max-login-attempts">Maximum Login Attempts</label>
                                <input type="number" id="max-login-attempts" class="form-control" value="5" min="3" max="10">
                            </div>
                            <div class="form-group">
                                <label for="lockout-duration">Account Lockout Duration (minutes)</label>
                                <input type="number" id="lockout-duration" class="form-control" value="15" min="5" max="1440">
                            </div>
                            <div class="form-group">
                                <label for="password-expiry">Password Expiry (days)</label>
                                <input type="number" id="password-expiry" class="form-control" value="90" min="30" max="365">
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="require-2fa" checked>
                                    <span>Require Two-Factor Authentication for all users</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="remember-me" checked>
                                    <span>Allow "Remember Me" functionality</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="force-logout" checked>
                                    <span>Force logout on password change</span>
                                </label>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Password Policy -->
                <div class="card">
                    <div class="card-header">
                        <h3>Password Policy</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label for="min-password-length">Minimum Password Length</label>
                                <input type="number" id="min-password-length" class="form-control" value="8" min="6" max="20">
                            </div>
                            <div class="form-group">
                                <label for="password-complexity">Password Complexity Requirements</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="require-uppercase" checked>
                                        <span>Require uppercase letters</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="require-lowercase" checked>
                                        <span>Require lowercase letters</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="require-numbers" checked>
                                        <span>Require numbers</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="require-special" checked>
                                        <span>Require special characters</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="password-history">Password History (prevent reuse of last N passwords)</label>
                                <input type="number" id="password-history" class="form-control" value="5" min="1" max="10">
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="prevent-common-passwords" checked>
                                    <span>Prevent common passwords</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="prevent-username-in-password" checked>
                                    <span>Prevent username in password</span>
                                </label>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Access Control -->
                <div class="card">
                    <div class="card-header">
                        <h3>Access Control</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label for="allowed-ip-ranges">Allowed IP Ranges</label>
                                <textarea id="allowed-ip-ranges" class="form-control" rows="3" placeholder="Enter IP ranges (one per line)&#10;Example:&#10;192.168.1.0/24&#10;10.0.0.0/8"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="blocked-ip-ranges">Blocked IP Ranges</label>
                                <textarea id="blocked-ip-ranges" class="form-control" rows="3" placeholder="Enter IP ranges to block (one per line)"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="geo-restrictions">Geographic Restrictions</label>
                                <select id="geo-restrictions" class="form-control">
                                    <option value="none">No restrictions</option>
                                    <option value="whitelist">Whitelist countries</option>
                                    <option value="blacklist">Blacklist countries</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="allowed-countries">Allowed Countries</label>
                                <select id="allowed-countries" class="form-control" multiple>
                                    <option value="US">United States</option>
                                    <option value="CA">Canada</option>
                                    <option value="GB">United Kingdom</option>
                                    <option value="DE">Germany</option>
                                    <option value="FR">France</option>
                                    <option value="AU">Australia</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="require-vpn" checked>
                                    <span>Require VPN for external access</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="log-access-attempts" checked>
                                    <span>Log all access attempts</span>
                                </label>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Data Protection -->
                <div class="card">
                    <div class="card-header">
                        <h3>Data Protection</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label for="data-retention">Data Retention Policy (days)</label>
                                <input type="number" id="data-retention" class="form-control" value="365" min="30" max="2555">
                            </div>
                            <div class="form-group">
                                <label for="encryption-level">Encryption Level</label>
                                <select id="encryption-level" class="form-control">
                                    <option value="AES-256">AES-256 (Recommended)</option>
                                    <option value="AES-192">AES-192</option>
                                    <option value="AES-128">AES-128</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="encrypt-at-rest" checked>
                                    <span>Encrypt data at rest</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="encrypt-in-transit" checked>
                                    <span>Encrypt data in transit (TLS/SSL)</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="mask-sensitive-data" checked>
                                    <span>Mask sensitive data in logs</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="anonymize-data" checked>
                                    <span>Anonymize data for analytics</span>
                                </label>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Security Monitoring -->
                <div class="card">
                    <div class="card-header">
                        <h3>Security Monitoring</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label for="security-alerts">Security Alert Settings</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="alert-failed-logins" checked>
                                        <span>Alert on failed login attempts</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="alert-suspicious-activity" checked>
                                        <span>Alert on suspicious activity</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="alert-privilege-escalation" checked>
                                        <span>Alert on privilege escalation</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="alert-data-access" checked>
                                        <span>Alert on sensitive data access</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="alert-email">Security Alert Email</label>
                                <input type="email" id="alert-email" class="form-control" value="security@company.com">
                            </div>
                            <div class="form-group">
                                <label for="alert-threshold">Alert Threshold (failed attempts)</label>
                                <input type="number" id="alert-threshold" class="form-control" value="3" min="1" max="10">
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="real-time-monitoring" checked>
                                    <span>Enable real-time security monitoring</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="automated-response" checked>
                                    <span>Enable automated security responses</span>
                                </label>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Compliance & Audit -->
                <div class="card">
                    <div class="card-header">
                        <h3>Compliance & Audit</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label for="audit-log-retention">Audit Log Retention (days)</label>
                                <input type="number" id="audit-log-retention" class="form-control" value="2555" min="365" max="3650">
                            </div>
                            <div class="form-group">
                                <label for="compliance-standards">Compliance Standards</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="gdpr-compliance" checked>
                                        <span>GDPR Compliance</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="sox-compliance" checked>
                                        <span>SOX Compliance</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="hipaa-compliance">
                                        <span>HIPAA Compliance</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="iso-27001">
                                        <span>ISO 27001</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="audit-trail" checked>
                                    <span>Maintain complete audit trail</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="data-classification" checked>
                                    <span>Enable data classification</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="regular-security-assessments" checked>
                                    <span>Schedule regular security assessments</span>
                                </label>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Security Actions -->
                <div class="card">
                    <div class="card-header">
                        <h3>Security Actions</h3>
                    </div>
                    <div class="card-body">
                        <div class="security-actions">
                            <div class="action-item">
                                <div class="action-info">
                                    <h4>Force Password Reset</h4>
                                    <p>Force all users to reset their passwords on next login</p>
                                </div>
                                <div class="action-button">
                                    <button class="btn btn-warning">Force Reset</button>
                                </div>
                            </div>
                            <div class="action-item">
                                <div class="action-info">
                                    <h4>Clear All Sessions</h4>
                                    <p>Logout all users and clear all active sessions</p>
                                </div>
                                <div class="action-button">
                                    <button class="btn btn-danger">Clear Sessions</button>
                                </div>
                            </div>
                            <div class="action-item">
                                <div class="action-info">
                                    <h4>Generate Security Report</h4>
                                    <p>Generate a comprehensive security assessment report</p>
                                </div>
                                <div class="action-button">
                                    <button class="btn btn-info">Generate Report</button>
                                </div>
                            </div>
                            <div class="action-item">
                                <div class="action-info">
                                    <h4>Backup Security Settings</h4>
                                    <p>Create a backup of current security configuration</p>
                                </div>
                                <div class="action-button">
                                    <button class="btn btn-secondary">Create Backup</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script th:src="@{/js/script.js}"></script>
</body>
</html>
