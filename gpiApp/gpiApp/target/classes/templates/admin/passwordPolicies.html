<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Policies - Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-tasks"></i>
                <span>Task Manager</span>
            </div>
        </div>

        <nav class="sidebar-nav">
            <a th:href="@{/admin/asminDashboard}" class="nav-item" data-page="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>

            <a th:href="@{/admin/userManagement}" class="nav-item" data-page="user-management">
                <i class="fas fa-users"></i>
                <span>User Management</span>
            </a>

            <a th:href="@{/admin/createUser}" class="nav-item" data-page="create-user">
                <i class="fas fa-user-plus"></i>
                <span>Create User</span>
            </a>

            <a th:href="@{/admin/rolesAndPermissions}" class="nav-item" data-page="roles-permissions">
                <i class="fas fa-user-shield"></i>
                <span>Roles & Permissions</span>
            </a>

            <a th:href="@{/admin/projectManagement}" class="nav-item" data-page="project-management">
                <i class="fas fa-project-diagram"></i>
                <span>Project Management</span>
            </a>

            <a th:href="@{/admin/globalTasks}" class="nav-item" data-page="global-tasks">
                <i class="fas fa-tasks"></i>
                <span>Global Tasks</span>
            </a>

            <a th:href="@{/admin/teamAssignment}" class="nav-item" data-page="team-assignment">
                <i class="fas fa-users-cog"></i>
                <span>Team Assignment</span>
            </a>

            <a th:href="@{/admin/globalReports}" class="nav-item" data-page="global-reports">
                <i class="fas fa-chart-bar"></i>
                <span>Global Reports</span>
            </a>

            <a th:href="@{/admin/activityLogs}" class="nav-item" data-page="activity-logs">
                <i class="fas fa-history"></i>
                <span>Activity Logs</span>
            </a>

            <a th:href="@{/admin/systemSettings}" class="nav-item" data-page="system-settings">
                <i class="fas fa-cog"></i>
                <span>System Settings</span>
            </a>

            <a th:href="@{/admin/integrations}" class="nav-item" data-page="integrations">
                <i class="fas fa-plug"></i>
                <span>Integrations</span>
            </a>

            <a th:href="@{/admin/securityAndBackups}" class="nav-item" data-page="security">
                <i class="fas fa-shield-alt"></i>
                <span>Security & Backup</span>
            </a>

            <div class="nav-divider"></div>

            <a th:href="@{/admin/support}" class="nav-item" data-page="support">
                <i class="fas fa-life-ring"></i>
                <span>Support Center</span>
            </a>

            <a th:href="@{/api/auth/logout-confirm}" id="logout-link" class="nav-item" style="margin-top: auto;">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Include Top Bar Fragment -->
        <div th:replace="~{fragments/adminfragmentTB :: topbar}"></div>

        <!-- Content Wrapper -->
        <div class="content-wrapper">
            <!-- Password Policies Page -->
            <div class="page-content active" id="password-policies">
                <div class="section-header">
                    <h2 class="section-title">Password Policies</h2>
                    <button class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Policies
                    </button>
                </div>

                <!-- Policy Overview -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-info">
                            <h3>8</h3>
                            <p>Minimum Length</p>
                        </div>
                        <div class="stat-icon" style="background-color: rgba(40, 167, 69, 0.1); color: var(--success);">
                            <i class="fas fa-ruler"></i>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-info">
                            <h3>90</h3>
                            <p>Expiry Days</p>
                        </div>
                        <div class="stat-icon" style="background-color: rgba(23, 162, 184, 0.1); color: var(--info);">
                            <i class="fas fa-calendar"></i>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-info">
                            <h3>5</h3>
                            <p>History Count</p>
                        </div>
                        <div class="stat-icon" style="background-color: rgba(255, 193, 7, 0.1); color: var(--warning);">
                            <i class="fas fa-history"></i>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-info">
                            <h3>4</h3>
                            <p>Complexity Rules</p>
                        </div>
                        <div class="stat-icon" style="background-color: rgba(108, 117, 125, 0.1); color: var(--secondary);">
                            <i class="fas fa-cogs"></i>
                        </div>
                    </div>
                </div>

                <!-- Password Policy Configuration -->
                <div class="card">
                    <div class="card-header">
                        <h3>Password Policy Configuration</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label for="min-password-length">Minimum Password Length</label>
                                <input type="number" id="min-password-length" class="form-control" value="8" min="6" max="20">
                                <small class="form-text">Minimum number of characters required</small>
                            </div>
                            <div class="form-group">
                                <label for="max-password-length">Maximum Password Length</label>
                                <input type="number" id="max-password-length" class="form-control" value="128" min="8" max="256">
                                <small class="form-text">Maximum number of characters allowed</small>
                            </div>
                            <div class="form-group">
                                <label for="password-expiry-days">Password Expiry (days)</label>
                                <input type="number" id="password-expiry-days" class="form-control" value="90" min="30" max="365">
                                <small class="form-text">Number of days before password expires</small>
                            </div>
                            <div class="form-group">
                                <label for="password-history-count">Password History Count</label>
                                <input type="number" id="password-history-count" class="form-control" value="5" min="1" max="10">
                                <small class="form-text">Number of previous passwords to prevent reuse</small>
                            </div>
                            <div class="form-group">
                                <label for="max-failed-attempts">Maximum Failed Attempts</label>
                                <input type="number" id="max-failed-attempts" class="form-control" value="5" min="3" max="10">
                                <small class="form-text">Number of failed attempts before account lockout</small>
                            </div>
                            <div class="form-group">
                                <label for="lockout-duration">Lockout Duration (minutes)</label>
                                <input type="number" id="lockout-duration" class="form-control" value="15" min="5" max="1440">
                                <small class="form-text">Duration of account lockout after failed attempts</small>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Complexity Requirements -->
                <div class="card">
                    <div class="card-header">
                        <h3>Password Complexity Requirements</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="require-uppercase" checked>
                                    <span>Require uppercase letters (A-Z)</span>
                                </label>
                                <small class="form-text">At least one uppercase letter required</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="require-lowercase" checked>
                                    <span>Require lowercase letters (a-z)</span>
                                </label>
                                <small class="form-text">At least one lowercase letter required</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="require-numbers" checked>
                                    <span>Require numbers (0-9)</span>
                                </label>
                                <small class="form-text">At least one number required</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="require-special-chars" checked>
                                    <span>Require special characters (!@#$%^&*)</span>
                                </label>
                                <small class="form-text">At least one special character required</small>
                            </div>
                            <div class="form-group">
                                <label for="min-uppercase-count">Minimum Uppercase Letters</label>
                                <input type="number" id="min-uppercase-count" class="form-control" value="1" min="0" max="5">
                            </div>
                            <div class="form-group">
                                <label for="min-lowercase-count">Minimum Lowercase Letters</label>
                                <input type="number" id="min-lowercase-count" class="form-control" value="1" min="0" max="5">
                            </div>
                            <div class="form-group">
                                <label for="min-numbers-count">Minimum Numbers</label>
                                <input type="number" id="min-numbers-count" class="form-control" value="1" min="0" max="5">
                            </div>
                            <div class="form-group">
                                <label for="min-special-count">Minimum Special Characters</label>
                                <input type="number" id="min-special-count" class="form-control" value="1" min="0" max="5">
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Password Restrictions -->
                <div class="card">
                    <div class="card-header">
                        <h3>Password Restrictions</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="prevent-common-passwords" checked>
                                    <span>Prevent common passwords</span>
                                </label>
                                <small class="form-text">Block commonly used passwords like "password", "123456", etc.</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="prevent-username-in-password" checked>
                                    <span>Prevent username in password</span>
                                </label>
                                <small class="form-text">Block passwords containing the username</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="prevent-personal-info" checked>
                                    <span>Prevent personal information in password</span>
                                </label>
                                <small class="form-text">Block passwords containing personal information</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="prevent-sequential-chars" checked>
                                    <span>Prevent sequential characters</span>
                                </label>
                                <small class="form-text">Block passwords with sequential characters like "123", "abc"</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="prevent-repeated-chars" checked>
                                    <span>Prevent repeated characters</span>
                                </label>
                                <small class="form-text">Block passwords with repeated characters like "aaa", "111"</small>
                            </div>
                            <div class="form-group">
                                <label for="max-repeated-chars">Maximum Repeated Characters</label>
                                <input type="number" id="max-repeated-chars" class="form-control" value="2" min="1" max="5">
                                <small class="form-text">Maximum number of consecutive repeated characters allowed</small>
                            </div>
                            <div class="form-group">
                                <label for="max-sequential-chars">Maximum Sequential Characters</label>
                                <input type="number" id="max-sequential-chars" class="form-control" value="2" min="1" max="5">
                                <small class="form-text">Maximum number of consecutive sequential characters allowed</small>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Policy Templates -->
                <div class="card">
                    <div class="card-header">
                        <h3>Password Policy Templates</h3>
                    </div>
                    <div class="card-body">
                        <div class="policy-templates">
                            <div class="template-item">
                                <div class="template-header">
                                    <h4>Basic Security</h4>
                                    <span class="template-badge basic">Basic</span>
                                </div>
                                <div class="template-details">
                                    <ul>
                                        <li>Minimum 8 characters</li>
                                        <li>Require uppercase and lowercase</li>
                                        <li>Require numbers</li>
                                        <li>90-day expiry</li>
                                    </ul>
                                </div>
                                <div class="template-actions">
                                    <button class="btn btn-sm btn-primary">Apply Template</button>
                                    <button class="btn btn-sm btn-secondary">Preview</button>
                                </div>
                            </div>

                            <div class="template-item">
                                <div class="template-header">
                                    <h4>Enhanced Security</h4>
                                    <span class="template-badge enhanced">Enhanced</span>
                                </div>
                                <div class="template-details">
                                    <ul>
                                        <li>Minimum 10 characters</li>
                                        <li>Require uppercase, lowercase, numbers</li>
                                        <li>Require special characters</li>
                                        <li>60-day expiry</li>
                                        <li>5 password history</li>
                                    </ul>
                                </div>
                                <div class="template-actions">
                                    <button class="btn btn-sm btn-primary">Apply Template</button>
                                    <button class="btn btn-sm btn-secondary">Preview</button>
                                </div>
                            </div>

                            <div class="template-item">
                                <div class="template-header">
                                    <h4>High Security</h4>
                                    <span class="template-badge high">High</span>
                                </div>
                                <div class="template-details">
                                    <ul>
                                        <li>Minimum 12 characters</li>
                                        <li>All complexity requirements</li>
                                        <li>30-day expiry</li>
                                        <li>10 password history</li>
                                        <li>Prevent common passwords</li>
                                    </ul>
                                </div>
                                <div class="template-actions">
                                    <button class="btn btn-sm btn-primary">Apply Template</button>
                                    <button class="btn btn-sm btn-secondary">Preview</button>
                                </div>
                            </div>

                            <div class="template-item">
                                <div class="template-header">
                                    <h4>Custom Policy</h4>
                                    <span class="template-badge custom">Custom</span>
                                </div>
                                <div class="template-details">
                                    <ul>
                                        <li>Configure your own settings</li>
                                        <li>Flexible requirements</li>
                                        <li>Custom expiry periods</li>
                                        <li>Advanced restrictions</li>
                                    </ul>
                                </div>
                                <div class="template-actions">
                                    <button class="btn btn-sm btn-primary">Create Custom</button>
                                    <button class="btn btn-sm btn-secondary">Save Template</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Policy Enforcement -->
                <div class="card">
                    <div class="card-header">
                        <h3>Policy Enforcement</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-grid">
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="enforce-policy-on-login" checked>
                                    <span>Enforce policy on login</span>
                                </label>
                                <small class="form-text">Check password compliance when users log in</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="enforce-policy-on-change" checked>
                                    <span>Enforce policy on password change</span>
                                </label>
                                <small class="form-text">Check password compliance when users change passwords</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="force-password-change" checked>
                                    <span>Force password change on policy update</span>
                                </label>
                                <small class="form-text">Require users to change passwords when policy is updated</small>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="notify-password-expiry" checked>
                                    <span>Notify users of password expiry</span>
                                </label>
                                <small class="form-text">Send notifications before passwords expire</small>
                            </div>
                            <div class="form-group">
                                <label for="expiry-notification-days">Expiry Notification (days before)</label>
                                <input type="number" id="expiry-notification-days" class="form-control" value="7" min="1" max="30">
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="prevent-login-on-expiry" checked>
                                    <span>Prevent login on password expiry</span>
                                </label>
                                <small class="form-text">Block login attempts with expired passwords</small>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Policy Analytics -->
                <div class="card">
                    <div class="card-header">
                        <h3>Password Policy Analytics</h3>
                    </div>
                    <div class="card-body">
                        <div class="analytics-grid">
                            <div class="analytics-item">
                                <h4>Password Strength Distribution</h4>
                                <div class="strength-chart">
                                    <div class="strength-item">
                                        <span class="strength-label">Strong</span>
                                        <div class="strength-bar">
                                            <div class="strength-fill strong" style="width: 65%;"></div>
                                        </div>
                                        <span class="strength-value">65%</span>
                                    </div>
                                    <div class="strength-item">
                                        <span class="strength-label">Medium</span>
                                        <div class="strength-bar">
                                            <div class="strength-fill medium" style="width: 25%;"></div>
                                        </div>
                                        <span class="strength-value">25%</span>
                                    </div>
                                    <div class="strength-item">
                                        <span class="strength-label">Weak</span>
                                        <div class="strength-bar">
                                            <div class="strength-fill weak" style="width: 10%;"></div>
                                        </div>
                                        <span class="strength-value">10%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="analytics-item">
                                <h4>Policy Compliance</h4>
                                <div class="compliance-metrics">
                                    <div class="metric-item">
                                        <div class="metric-icon">
                                            <i class="fas fa-check-circle"></i>
                                        </div>
                                        <div class="metric-info">
                                            <h5>Compliant Users</h5>
                                            <span class="metric-value">87.5%</span>
                                        </div>
                                    </div>
                                    <div class="metric-item">
                                        <div class="metric-icon">
                                            <i class="fas fa-exclamation-triangle"></i>
                                        </div>
                                        <div class="metric-info">
                                            <h5>Non-Compliant Users</h5>
                                            <span class="metric-value">12.5%</span>
                                        </div>
                                    </div>
                                    <div class="metric-item">
                                        <div class="metric-icon">
                                            <i class="fas fa-clock"></i>
                                        </div>
                                        <div class="metric-info">
                                            <h5>Expiring Soon</h5>
                                            <span class="metric-value">23 users</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Policy Actions -->
                <div class="card">
                    <div class="card-header">
                        <h3>Policy Actions</h3>
                    </div>
                    <div class="card-body">
                        <div class="policy-actions">
                            <div class="action-item">
                                <div class="action-info">
                                    <h4>Force Password Reset</h4>
                                    <p>Force all users to reset their passwords to comply with new policy</p>
                                </div>
                                <div class="action-button">
                                    <button class="btn btn-warning">Force Reset</button>
                                </div>
                            </div>
                            <div class="action-item">
                                <div class="action-info">
                                    <h4>Audit Password Compliance</h4>
                                    <p>Generate a report of all users and their password compliance status</p>
                                </div>
                                <div class="action-button">
                                    <button class="btn btn-info">Generate Report</button>
                                </div>
                            </div>
                            <div class="action-item">
                                <div class="action-info">
                                    <h4>Send Password Reminders</h4>
                                    <p>Send reminders to users with weak or expiring passwords</p>
                                </div>
                                <div class="action-button">
                                    <button class="btn btn-secondary">Send Reminders</button>
                                </div>
                            </div>
                            <div class="action-item">
                                <div class="action-info">
                                    <h4>Export Policy Settings</h4>
                                    <p>Export current password policy settings for backup or documentation</p>
                                </div>
                                <div class="action-button">
                                    <button class="btn btn-primary">Export Settings</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script th:src="@{/js/script.js}"></script>
</body>
</html>
